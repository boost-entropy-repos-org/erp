MODULE InvoiceContract;

REQUIRE StockContract;

META defineInvoicePaymentCondition (sign)

    paymentConditionInvoice 'Условия оплаты' = ABSTRACT PaymentCondition (Invoice) PERSISTENT;
    paymentConditionUserInvoice 'Условия оплаты' = DATA PaymentCondition (UserInvoice);
    paymentConditionInvoice(prop) += paymentConditionUserInvoice(prop);
    paymentConditionInContractLedger(prop) += paymentConditionInvoice(prop);

    descriptionPaymentConditionInvoice 'Условия оплаты' (i) = descriptionPaymentCondition(paymentConditionInvoice(i)) IN base;
    descriptionPaymentConditionUserInvoice 'Условия оплаты' (i) = descriptionPaymentCondition(paymentConditionUserInvoice(i));

    paymentConditionUserInvoice(prop) <- OVERRIDE paymentConditionAgreement(agreementUserInvoice(prop)), paymentConditionContractSku(contractSkuUserInvoice(prop))
        WHEN CHANGED(agreementUserInvoice(prop)) OR
             CHANGED(contractSkuUserInvoice(prop));

    EXTEND FORM userInvoice
        PROPERTIES(i) descriptionPaymentConditionUserInvoice
    ;

    EXTEND DESIGN userInvoice{
        i.documentPrmGroup{
            ADD PROPERTY(descriptionPaymentConditionUserInvoice);
        }
    }

END
