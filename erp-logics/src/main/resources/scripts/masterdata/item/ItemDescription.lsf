MODULE ItemDescription;

REQUIRE System, Item;

NAMESPACE Item;

GROUP itemDescription 'Описание' : public;

// Вид
CLASS Type 'Вид товара';
TABLE type(Type);

nameType 'Наименование' = DATA VARISTRING[50](Type);

FORM type 'Вид товара'
    OBJECTS t=Type FIXED PANEL
    PROPERTIES(t) nameType
    EDIT Type OBJECT t
;

FORM types 'Виды товара'
    OBJECTS t=Type
    PROPERTIES(t) nameType READONLY, DELETE FORCE PANEL TOOLBAR
    PROPERTIES(t) ADDFORM, EDITFORM
    ORDER BY nameType(t)
    DIALOG Type OBJECT t
;
DESIGN types FROM DEFAULT { main{ preferredSize = (600, 400); } }

@defineObjectItemAttribute(type, Type, nameType, 'Вид', itemDescription);
@defineObjectItemAttributeBatch (type, nameType, 'Вид');
@implementItemAttribute(nameType, 'Вид', String, itemType);

@defineItemDefaultValue(type, 'Вид', Type, nameType);
@defineItemFilterValue(type, 'Вид');

// Сорт
CLASS Sort 'Сорт товара';
TABLE sort(Sort);

nameSort 'Наименование' = DATA VARISTRING[50](Sort);

FORM sort 'Сорт товара'
    OBJECTS t=Sort FIXED PANEL
    PROPERTIES(t) nameSort
    EDIT Sort OBJECT t
;

FORM sorts 'Сорта товара'
    OBJECTS t=Sort
    PROPERTIES(t) nameSort READONLY, DELETE FORCE PANEL TOOLBAR
    PROPERTIES(t) ADDFORM, EDITFORM
    ORDER BY nameSort(t)
    DIALOG Sort OBJECT t
;
DESIGN sorts FROM DEFAULT { main{ preferredSize = (600, 400); } }

@defineObjectItemAttribute(sort, Sort, nameSort, 'Сорт', itemDescription);
@defineObjectItemAttributeBatch (sort, nameSort, 'Сорт');
@implementItemAttribute(nameSort, 'Сорт', String, itemSort);

@defineItemDefaultValue(sort, 'Сорт', Sort, nameSort);
@defineItemFilterValue(sort, 'Сорт');

// Форма
CLASS Form 'Форма товара';
TABLE form(Form);

nameForm 'Наименование' = DATA VARISTRING[50](Form);

FORM form 'Форма товара'
    OBJECTS t=Form FIXED PANEL
    PROPERTIES(t) nameForm
    EDIT Form OBJECT t
;

FORM forms 'Формы товара'
    OBJECTS t=Form
    PROPERTIES(t) nameForm READONLY, DELETE FORCE PANEL TOOLBAR
    PROPERTIES(t) ADDFORM, EDITFORM
    ORDER BY nameForm(t)
    DIALOG Form OBJECT t
;
DESIGN forms FROM DEFAULT { main{ preferredSize = (600, 400); } }

@defineObjectItemAttribute(form, Form, nameForm, 'Форма', itemDescription);
@defineObjectItemAttributeBatch (form, nameForm, 'Форма');
@implementItemAttribute(nameForm, 'Форма', String, itemForm);

@defineItemDefaultValue(form, 'Форма', Form, nameForm);
@defineItemFilterValue(form, 'Форма');

// Особенность
CLASS Feature 'Особенность товара';
TABLE feature(Feature);

nameFeature 'Наименование' = DATA VARISTRING[50](Feature);

FORM feature 'Особенность товара'
    OBJECTS t=Feature FIXED PANEL
    PROPERTIES(t) nameFeature
    EDIT Feature OBJECT t
;

FORM features 'Особенности товара'
    OBJECTS t=Feature
    PROPERTIES(t) nameFeature READONLY, DELETE FORCE PANEL TOOLBAR
    PROPERTIES(t) ADDFORM, EDITFORM
    ORDER BY nameFeature(t)
    DIALOG Feature OBJECT t
;
DESIGN features FROM DEFAULT { main{ preferredSize = (600, 400); } }

@defineObjectItemAttribute(feature, Feature, nameFeature, 'Особенность', itemDescription);
@defineObjectItemAttributeBatch (feature, nameFeature, 'Особенность');
@implementItemAttribute(nameFeature, 'Особенность', String, itemFeature);

@defineItemDefaultValue(feature, 'Особенность', Feature, nameFeature);
@defineItemFilterValue(feature, 'Особенность');

// Упаковка
CLASS Pack 'Упаковка';
TABLE pack(Pack);

namePack 'Наименование' = DATA VARISTRING[50](Pack);

FORM pack 'Упаковка'
    OBJECTS t=Pack FIXED PANEL
    PROPERTIES(t) namePack
    EDIT Pack OBJECT t
;

FORM packs 'Упаковки'
    OBJECTS t=Pack
    PROPERTIES(t) namePack READONLY, DELETE FORCE PANEL TOOLBAR
    PROPERTIES(t) ADDFORM, EDITFORM
    ORDER BY namePack(t)
    DIALOG Pack OBJECT t
;
DESIGN packs FROM DEFAULT { main{ preferredSize = (600, 400); } }

@defineObjectItemAttribute(pack, Pack, namePack, 'Упаковка', itemDescription);
@defineObjectItemAttributeBatch (pack, namePack, 'Упаковка');
@implementItemAttribute(namePack, 'Упаковка', String, itemPack);

@defineItemDefaultValue(pack, 'Упаковка', Pack, namePack);
@defineItemFilterValue(pack, 'Упаковка');

// Свойство
@defineStringItemAttribute(property, VARSTRING[100], 'Свойство', itemDescription);
@defineItemAttributeBatch (property, 'Свойство');
@implementItemAttribute(property, 'Свойство', String, itemProperty);

// Кол-во компонентов
@defineIntegerItemAttribute(numberComponents, 'Кол-во компонентов', itemDescription);
@defineItemAttributeBatch (numberComponents, 'Кол-во компонентов');
@implementItemAttribute(numberComponents, 'Кол-во компонентов', Integer, itemNumberComponents);

// Код артикула
@defineStringItemAttribute(articleCode, VARSTRING[100], 'Код артикула', itemDescription);
@defineItemAttributeBatch (articleCode, 'Код артикула');
@implementItemAttribute(articleCode, 'Код артикула', String, itemArticleCode);

overCopyItem(s, d) += ACTION (s, d) {
    typeItem(d) <- typeItem(s);
    sortItem(d) <- sortItem(s);
    formItem(d) <- formItem(s);
    featureItem(d) <- featureItem(s);
    packItem(d) <- packItem(s);
    propertyItem(d) <- propertyItem(s);
    numberComponentsItem(d) <- numberComponentsItem(s);
}


EXTEND DESIGN item {
    itemPrimaryColumn1 {
        ADD i.itemDescription {
            columns = 2;
        }
    }
}

EXTEND DESIGN itemGroup {
    itemGroupDetail {
        ADD g.itemDescription {
            columns = 6;
        }
    }
}

NAVIGATOR {
    itemAttributeNavigator {
        ADD types;
        ADD sorts;
        ADD forms;
        ADD features;
        ADD packs;
    }
}

