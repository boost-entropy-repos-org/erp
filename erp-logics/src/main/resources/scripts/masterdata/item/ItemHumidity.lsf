MODULE ItemHumidity;

REQUIRE System, Item;

NAMESPACE Item;

GROUP itemHumidity 'Влажность' : public;

percentHumidity 'Влажность, %' = DATA NUMERIC[8,2] (Item) IN itemHumidity;
percentDryness 'Массовая доля сухих веществ, %' (Item item) = 100 - (OVERRIDE 0 IF item IS Item, percentHumidity(item)) IN itemHumidity; 

changePercentDryness(Item item)  = {
    INPUT n = NUMERIC[8,2] DO
        percentHumidity(item) <- 100.00-n;
}

@defineItemAttribute(humidity, 'Влажность', itemHumidity);

EXTEND FORM itemGroup PROPERTIES(g) userShowHumidity;
EXTEND FORM itemGroups PROPERTIES(g) READONLYIF  isReadonly() showHumidity BACKGROUND backgroundShowHumidity(g) BEFORE deleteg;
DESIGN itemGroup {
    itemGroupDetail1 {
        MOVE g.itemHumidity {
        }
    }
}

overCopy(Item s, Item d) += {
    ASSIGN percentHumidity(d) <- percentHumidity(s);
}

EXTEND FORM item 
    PROPERTIES(i) SHOWIF showHumidity(i) percentHumidity, percentDryness ON CHANGE  changePercentDryness(i)
;
DESIGN item {
    itemPrimaryColumn1 {
        MOVE i.itemHumidity {
//            columns = 2;
        }
    }
}
EXTEND FORM items 
    PROPERTIES(i) READONLYIF isReadonly() BEFORE deletei SHOWIF showHumidity(g) percentHumidity
;
