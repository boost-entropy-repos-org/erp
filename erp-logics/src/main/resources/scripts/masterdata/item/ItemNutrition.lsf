MODULE ItemNutrition;

REQUIRE System, Item;

NAMESPACE Item;

GROUP itemNutrition 'Энергетическая ценность' : public;

energy 'Энергетическая ценность на 100г, ккал' = DATA NUMERIC[8,2] (Item) IN itemNutrition;
fats 'Жиры на 100г, г' = DATA NUMERIC[8,2] (Item) IN itemNutrition;
carbohydrates 'Углеводы на 100г, г' = DATA NUMERIC[8,2] (Item) IN itemNutrition;
proteins 'Белки на 100г, г' = DATA NUMERIC[8,2] (Item) IN itemNutrition;
containsGMO 'Содержит ГМО' = DATA BOOLEAN (Item) IN itemNutrition;

//energyItem 'Энергетическая ценность на 100г, ккал' = DATA NUMERIC[8,2] (Item) IN itemNutrition;
//fatsItem 'Жиры на 100г, г' = DATA NUMERIC[8,2] (Item) IN itemNutrition;
//carbohydratesItem 'Углеводы на 100г, г' = DATA NUMERIC[8,2] (Item) IN itemNutrition;
//proteinsItem 'Белки на 100г, г' = DATA NUMERIC[8,2] (Item) IN itemNutrition;

@defineItemAttribute(energy, 'Энергетическая ценность', itemNutrition);

EXTEND FORM itemGroup PROPERTIES(g) userShowEnergy;
EXTEND FORM itemGroups PROPERTIES(g) READONLYIF  isReadonly() showEnergy BACKGROUND backgroundShowEnergy(g) BEFORE deleteg;
DESIGN itemGroup {
    itemGroupDetail1 {
        MOVE g.itemNutrition;
    }
}

overCopy(Item s, Item d) += ACTION (s, d) {
    ASSIGN energy(d) <- energy(s);
    ASSIGN fats(d) <- fats(s);
    ASSIGN carbohydrates(d) <- carbohydrates(s);
    ASSIGN proteins(d) <- proteins(s);
    ASSIGN containsGMO(d) <- containsGMO(s);
}

EXTEND FORM item 
    PROPERTIES(i) SHOWIF showEnergy(i) energy, fats, carbohydrates, proteins, containsGMO
;
DESIGN item {
    itemPrimaryColumn2 {
        MOVE i.itemNutrition {
            columns = 2;
        }
    }
}
EXTEND FORM items 
    PROPERTIES(i) READONLYIF isReadonly() BEFORE deletei SHOWIF showEnergy(g)
                  energy, fats, carbohydrates, proteins, containsGMO
;
