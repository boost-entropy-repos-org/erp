MODULE LegalEntityRegion;

REQUIRE LegalEntity, Stock;

NAMESPACE LegalEntity;

TABLE legalEntityRegion (LegalEntity, Region);

email 'E-mail' = DATA VARSTRING[400](LegalEntity, Region);

EXTEND FORM legalEntity
    OBJECTS r = Region
    PROPERTIES name (r) READONLY, email(l,r)
    PROPERTIES(r) NEWSESSION NEW, EDIT, DELETE FORCE PANEL TOOLBAR
;

DESIGN legalEntity {
    extendContainer {
        NEW regional{
            caption = 'Регионы';
            MOVE r.box;
        }
    }
}

regionalEmail (LegalEntity l, Stock s) = OVERRIDE email(l, region(stockGroup(s))), email(l, region(s));

overRegionalEmail = OVERRIDE email(LegalEntity l) IF Stock s IS Stock, regionalEmail(l, s);