MODULE DiscountCardReceiptSkuLedger;

REQUIRE ZReportDiscountCard;

NAMESPACE DiscountCard;

nameDOW 'День недели' (Receipt r) = extractDOWName(date(r));


hour 'Час' (ReceiptDetail d) = extractHour(dateTime(d));  
nameDOW 'День недели' (ReceiptDetail d) = extractDOWName(date(d));
nameMonth 'Месяц' (ReceiptDetail d) = extractMonthName(date(d));

EXTEND FORM discountCards
    OBJECTS r=Receipt
    PROPERTIES(r) READONLY nameDOW, dateTime, nameDepartmentStore, description, sumReceiptDetail, discountSumReceiptDetail, countReceiptDetail, quantityReceiptDetail
    ORDER BY dateTime(r)
        
    OBJECTS l=ReceiptDetail
    PROPERTIES(l) READONLY type, nameSku, number, quantity, price, 
                            sum, discountSum, valueVAT
    FILTERS receipt(l)==r                          
    
;
DESIGN discountCards {
    tabbed {
        NEW detail {
            caption = 'Чеки';
            type = SPLITH;
            MOVE r.box;
            MOVE l.box;
        }
    }
}