MODULE DiscountCardReceiptSkuLedger;

REQUIRE ZReportDiscountCard;

NAMESPACE DiscountCard;

hour 'Час' (ReceiptDetail d) = extractHour(dateTime(d));  
nameDOW 'День недели' (ReceiptDetail d) = extractDOWName(date(d));
nameMonth 'Месяц' (ReceiptDetail d) = extractMonthName(date(d));

EXTEND FORM discountCards
    OBJECTS l=ReceiptDetail
    PROPERTIES(l) READONLY type, nameDOW, dateTime,  
                           nameDepartmentStore, nameSku, description, number,
                           quantity, price, sum, discountSum, valueVAT
//                           costSumSaleLedger, markupSumSaleLedger, valueVATSaleLedger, sumVATSaleLedger, sumSaleLedger, averagePriceSaleLedger   
    ORDER BY dateTime(l)                        
    FILTERS discountCard(l)==d OR discountCard(receiptSale(l))==d                           
    
;
DESIGN discountCards {
    main {
        MOVE d.box;
        MOVE l.box;
        MOVE functions.box;
    }
}