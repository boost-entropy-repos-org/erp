MODULE ExtraUOM;

REQUIRE Item;

dataCoefficient 'Коэффициент' = DATA NUMERIC[14,6] (UOM, UOM);
coefficient 'Коэффициент' (UOM uom1, UOM uom2) = IF uom1==uom2 THEN 1.0 ELSE dataCoefficient(uom1, uom2); 

WHEN LOCAL CHANGED(dataCoefficient(UOM uom1, UOM uom2)) DO {
    dataCoefficient(uom2, uom1) <- 1.0 / dataCoefficient(uom1, uom2);    
}

EXTEND FORM attributesItem
    OBJECTS extUOM = UOM
    PROPERTIES READONLY name(extUOM)
    PROPERTIES coefficient(UOM, extUOM)
    ORDER BY name(extUOM)          
    FILTERGROUP coefficient
        FILTER 'С коэффициентом' coefficient(UOM, extUOM) DEFAULT
;

DESIGN attributesItem{
    UOMTabBottomContainer{
        MOVE extUOM.box{
            caption ='Коэффициенты перевода';
        }
    }
}
