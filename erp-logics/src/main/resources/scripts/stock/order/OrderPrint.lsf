MODULE OrderPrint;

REQUIRE LegalEntity, Bank, Order;

NAMESPACE Order;

@defineDocumentAccount(order, supplier, ' поставщика');
@defineDocumentPhone(order, supplier, ' поставщика');

@defineDocumentAccount(order, customer, ' покупателя');
@defineDocumentPhone(order, customer, ' покупателя');

FORM printOrder 'Счет-фактура (печать)'
    OBJECTS o = Order FIXED PANEL
    PROPERTIES (o) READONLY nameSupplierOrder, nameSupplierStockOrder, addressSupplierOrder, 
                   numberAccountSupplierOrder, nameBankSupplierOrder, addressBankSupplierOrder,
                   departmentBankSupplierOrder, CBUBankSupplierOrder, MFOBankSupplierOrder, phoneSupplierOrder,
                   nameCustomerOrder, nameCustomerStockOrder, addressCustomerOrder, 
                   numberAccountCustomerOrder, nameBankCustomerOrder, addressBankCustomerOrder,
                   departmentBankCustomerOrder, CBUBankCustomerOrder, MFOBankCustomerOrder, phoneCustomerOrder,
                   numberOrder, seriesOrder, seriesNumberOrder, dateOrder, timeOrder, closeDateOrder, currencyOrder,
                   nameCurrencyOrder, noteOrder, countOrderDetailOrder, quantityOrderDetailOrder, sumOrderDetailOrder,
                   VATSumOrderDetailOrder, invoiceSumOrderDetailOrder, nameAcquisitionTargetOrder

    OBJECTS d = OrderDetail
    PROPERTIES (d) READONLY indexOrderDetail, nameSkuOrderDetail, shortNameUOMSkuOrderDetail,
                   quantityOrderDetail,
                   priceOrderDetail, sumOrderDetail, numberVATOrderDetail,
                   valueVATOrderDetail,  VATSumOrderDetail, invoiceSumOrderDetail
    FILTERS orderOrderDetail(d) == o
;

printOrder 'Счет-фактура' (order) = ACTION FORM printOrder OBJECTS o = order PRINT  IMAGE 'print.png' IN print;

FORM printOrderXLS 'Заказ'
    OBJECTS o = Order FIXED PANEL
    PROPERTIES (o) READONLY nameSupplierOrder, fullNameSupplierOrder, nameSupplierStockOrder, addressSupplierOrder, 
                   numberAccountSupplierOrder, nameBankSupplierOrder, addressBankSupplierOrder,
                   departmentBankSupplierOrder, CBUBankSupplierOrder, MFOBankSupplierOrder, phoneSupplierOrder,
                   nameCustomerOrder, fullNameCustomerOrder, nameCustomerStockOrder, addressCustomerOrder, 
                   numberAccountCustomerOrder, nameBankCustomerOrder, addressBankCustomerOrder,
                   departmentBankCustomerOrder, CBUBankCustomerOrder, MFOBankCustomerOrder, phoneCustomerOrder,
                   numberOrder, seriesOrder, seriesNumberOrder, dateOrder, timeOrder, closeDateOrder, currencyOrder,
                   nameCurrencyOrder, noteOrder, countOrderDetailOrder, quantityOrderDetailOrder, sumOrderDetailOrder,
                   VATSumOrderDetailOrder, invoiceSumOrderDetailOrder, shipmentDateTimeOrder, shipmentDateOrder, shipmentTimeOrder, 
                   addressCustomerStockOrder, descriptionContractSkuOrder, createdNameUserOrder

    OBJECTS d = OrderDetail
    PROPERTIES (d) READONLY indexOrderDetail, nameSkuOrderDetail, idSkuOrderDetail, idBarcodeSkuOrderDetail, shortNameUOMSkuOrderDetail,
                   quantityOrderDetail,
                   priceOrderDetail, sumOrderDetail, numberVATOrderDetail,
                   valueVATOrderDetail,  VATSumOrderDetail, invoiceSumOrderDetail
    FILTERS orderOrderDetail(d) == o
;

excelOrder 'Заказ (xls)' (order) = ACTION FORM printOrderXLS OBJECTS o = order PRINT XLSX IN print;