MODULE SaleStatisticsItem;

REQUIRE SaleStatistics, Item;

NAMESPACE Sale;

statisticGroupTypeItem 'Статистическая группа' = DATA StatisticGroup (StatisticGroupType, Item);
nameStatisticGroupTypeItem 'Статистическая группа' = nameStatisticGroup(statisticGroupTypeItem(type, item));

CONSTRAINT groupTypeStatisticGroup(parentStatisticGroup(group)) != groupTypeStatisticGroup(group)
           CHECKED BY parentStatisticGroup MESSAGE 'Родительский объект статистической группы имеет неправильный тип классификатора';

statisticGroupTypeSku (type, sku) += statisticGroupTypeItem (type, sku);

overCopyItem(s, d) += ACTION (s, d) {
    ASSIGN statisticGroupTypeItem(type, d) <- statisticGroupTypeItem(type, s) WHERE statisticGroupTypeItem(type, s);
}

EXTEND FORM item
    OBJECTS sgt = StatisticGroupType
    PROPERTIES(sgt) READONLY nameStatisticGroupType, idStatisticGroupType
    FILTERS countryStatisticGroupType(sgt) == c

    PROPERTIES(sgt,i) nameStatisticGroupTypeItem
;
EXTEND DESIGN item { regionalPrm { ADD sgt.box;} }
