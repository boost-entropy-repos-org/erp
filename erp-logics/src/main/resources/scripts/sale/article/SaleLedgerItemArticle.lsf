MODULE SaleLedgerItemArticle;

REQUIRE SaleLedger, ItemArticle;

NAMESPACE SaleLedger;

idArticleItemSaleLedger 'Артикул' (ledger) = idArticleItem(skuSaleLedger(ledger));
nameColorItemSaleLedger 'Цвет' (ledger) = nameColorItem(skuSaleLedger(ledger));
nameSizeItemSaleLedger 'Размер' (ledger) = nameSizeItem(skuSaleLedger(ledger));

EXTEND FORM saleLedger
    PROPERTIES(s) READONLY BEFORE nameSkuSaleLedger(s) nameSizeItemSaleLedger, nameColorItemSaleLedger, idArticleItemSaleLedger 
;

quantitySoldArticleStockDateFromTo 'Продано за интервал (кол-во)' (article, stock, dateFrom, dateTo) = GROUP SUM
        quantitySoldSkuStockDate(sku, stock, date) IF date >= dateFrom AND date <= dateTo
        BY articleItem(sku), stock, dateFrom, dateTo;

sumSoldArticleStockDateFromTo 'Продано за интервал (сумма)' (article, stock, dateFrom, dateTo) = GROUP SUM
        sumSoldSkuStockDate(sku, stock, date) IF date >= dateFrom AND date <= dateTo
        BY articleItem(sku), stock, dateFrom, dateTo;
        
sumBArticleStockDate 'Сумма на начало дня' (article, stock, date) = GROUP SUM sumBSkuStockDate(sku, stock, date) BY articleItem(sku), stock, date;   
sumAArticleStockDate 'Сумма на конец дня' (article, stock, date) = GROUP SUM sumASkuStockDate(sku, stock, date) BY articleItem(sku), stock, date;   