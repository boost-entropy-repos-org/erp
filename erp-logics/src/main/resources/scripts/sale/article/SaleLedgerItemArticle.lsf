MODULE SaleLedgerItemArticle;

REQUIRE SaleLedgerItem, ItemArticle;

NAMESPACE SaleLedger;

idArticleItem 'Артикул' (SaleLedger ledger) = idArticle(sku(ledger));
nameColorItem 'Цвет' (SaleLedger ledger) = nameColor(sku(ledger));
nameSizeItem 'Размер' (SaleLedger ledger) = nameSize(sku(ledger));

EXTEND FORM saleLedger
    PROPERTIES(s) READONLY BEFORE nameSku(s) nameSizeItem, nameColorItem, idArticleItem 
;

quantitySold 'Продано за интервал (кол-во)' (article, stock, dateFrom, dateTo) = GROUP
        BY article(Item sku), Stock stock, DATE dateFrom, DATE dateTo SUM
        quantitySold(sku, stock, DATE date) IF date >= dateFrom AND date <= dateTo;

sumSold 'Продано за интервал (сумма)' (article, stock, dateFrom, dateTo) = GROUP
        BY article(Item sku), Stock stock, DATE dateFrom, DATE dateTo SUM
        sumSold(sku, stock, DATE date) IF date >= dateFrom AND date <= dateTo;
        
sumB 'Сумма на начало дня' (article, stock, date) = GROUP BY article(Item sku), Stock stock, DATE date SUM sumB(sku, stock, date);   
sumA 'Сумма на конец дня' (article, stock, date) = GROUP BY article(Item sku), Stock stock, DATE date SUM sumA(sku, stock, date);   