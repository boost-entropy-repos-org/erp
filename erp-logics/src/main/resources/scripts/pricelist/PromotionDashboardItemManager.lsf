MODULE PromotionDashboardItemManager;

REQUIRE PromotionDashboard, ItemManager;

NAMESPACE PromotionDashboard;

in = GROUP SUM 1 BY priceList(PriceListDetail detail), itemGroup(sku(detail));
access = GROUP SUM 1 IF countAccessItem(Employee employee, ItemGroup group) AND in(PriceList priceList, group) BY employee, priceList;

EXTEND FORM promotionDashboard
    FILTERS countAccessItem(currentUser(), cskg) OR NOT cskg IS SkuGroup
    FILTERS access(currentUser(), sku(csk))
    FILTERS access(currentUser(), p)
;

EXTEND FORM userPriceList 
    FILTERS countAccessItem(currentUser(), sk) OR NOT sk IS SkuGroup
    FILTERS countAccessItem(currentUser(), sk2) OR NOT sk IS SkuGroup
    FILTERS access(currentUser(), s2)
;