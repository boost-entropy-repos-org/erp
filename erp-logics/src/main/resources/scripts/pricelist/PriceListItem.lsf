MODULE PriceListItem;

REQUIRE PriceList, Item;

NAMESPACE PriceList;

//Производитель
filterManufacturerUserPriceList = DATA SESSION Manufacturer (UserPriceList);
nameFilterManufacturerUserPriceList 'Производитель' (userPriceList) = nameManufacturer(filterManufacturerUserPriceList(userPriceList)); 
   
filterManufacturerUserPriceListSku (userPriceList, sku) =
    filterManufacturerUserPriceList(userPriceList) == manufacturerItem(sku) OR sku IS Item AND NOT filterManufacturerUserPriceList(userPriceList);    
   
filterManufacturerUserPriceListBatch (userPriceList, batch) =
    filterManufacturerUserPriceList(userPriceList) == manufacturerBatch(batch) OR batch IS Batch AND NOT filterManufacturerUserPriceList(userPriceList);      

EXTEND FORM userPriceList
    PROPERTIES(p) FORCE PANEL nameFilterManufacturerUserPriceList
    FILTERS filterManufacturerUserPriceListSku(p, s2)
    FILTERS filterManufacturerUserPriceListBatch(p, b)
;

EXTEND DESIGN userPriceList {
    filtersContainer {
        ADD PROPERTY(nameFilterManufacturerUserPriceList(p));
    }
}

currentPricePriceListTypeSkuStockCompany 'Прайсовая цена' (type, sku, stock, company) = activePriceALedgerPriceListTypeSkuStockCompanyDateTime(type, sku, stock, company, currentDateTime());

EXTEND FORM item
    OBJECTS tlc = (tc = DataPriceListType, lc = LegalEntity) FIXED GRID
    FILTERS   currentPricePriceListTypeSkuStockCompany  (tc, i, st2, lc)
    
    PROPERTIES  READONLY nameDataPriceListType(tc), nameLegalEntity(lc), includeVATPriceListType(tc), 
                nameCurrencyDataPriceListType(tc), nameRoundConditionPriceListType(tc) 
    PROPERTIES(tc, i, st2, lc) READONLY currentPricePriceListTypeSkuStockCompany                            
                      
;
EXTEND DESIGN item {
    calcPriceListTypePrm {
        ADD tlc.box;
    }
}

