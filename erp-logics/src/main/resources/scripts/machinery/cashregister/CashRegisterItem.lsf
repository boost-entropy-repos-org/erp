MODULE CashRegisterItem;

REQUIRE Item, CashRegisterPriceTransaction;

idSkuGroupMachineryPriceTransactionBarcode (machineryPriceTransaction, barcode) = idItemGroup(skuGroupMachineryPriceTransactionBarcode(machineryPriceTransaction, barcode));

overTitleCashRegisterMachineryPriceTransactionBarcode = ABSTRACT VARISTRING[255] (MachineryPriceTransaction, Barcode);

createAttributeMachineryPriceTransactionGroupMachinery(transaction, groupMachinery) += ACTION (transaction, groupMachinery) {
    IF groupMachinery IS GroupCashRegister THEN
        nameMachineryPriceTransactionBarcode(transaction, barcode) <- (OVERRIDE titleCashRegisterBarcode(barcode), overTitleCashRegisterMachineryPriceTransactionBarcode(transaction, barcode)) WHERE inMachineryPriceTransactionBarcode(transaction, barcode);
}

maxCharactersNameCashRegisterItem 'Максимальное количество знаков в наименовании для касс' = DATA INTEGER ();

EXTEND FORM options
    PROPERTIES() maxCharactersNameCashRegisterItem
;
DESIGN options {
    commons {
        ADD PROPERTY(maxCharactersNameCashRegisterItem());
    }
}

CONSTRAINT charLength(titleCashRegisterBarcode(barcodeSku(item))) > maxCharactersNameCashRegisterItem() 
    MESSAGE 'Максимальное количество знаков в наименовании для касс больше предельного значения';
