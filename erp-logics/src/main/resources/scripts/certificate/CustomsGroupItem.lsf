MODULE CustomsGroupItem;

REQUIRE CustomsGroup, Item;

customsGroupCountryItem = DATA CustomsGroup(Country, Item);
codeCustomsGroupCountryItem 'ТН ВЭД' (country, item) = codeCustomsGroup(customsGroupCountryItem(country, item));
codeCustomsGroupDefaultCountryItem 'ТН ВЭД' (item) = codeCustomsGroup(customsGroupCountryItem(defaultCountry(), item));

customsGroupCountrySku(country, sku) += customsGroupCountryItem(country, sku);

CONSTRAINT customsZoneCustomsGroup(customsGroupCountryItem(country, item)) != customsZoneCountry(country) CHECKED BY customsGroupCountryItem
    MESSAGE 'Таможенная зона должна соответствовать стране';

EXTEND FORM item
    PROPERTIES(c, i) codeCustomsGroupCountryItem
    PROPERTIES(i) READONLY codeCustomsGroupDefaultCountryItem
;
EXTEND DESIGN item { regionPrm  { ADD PROPERTY(codeCustomsGroupDefaultCountryItem); } }

overCopyItem(s, d) += ACTION (s, d) {
    ASSIGN customsGroupCountryItem(c,d) <- customsGroupCountryItem(c,s) WHERE customsGroupCountryItem(c,s);
}

