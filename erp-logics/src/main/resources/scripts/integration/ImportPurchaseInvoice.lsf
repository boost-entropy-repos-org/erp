MODULE ImportPurchaseInvoice;

REQUIRE System,
        CustomsGroupArticle,
        ImportDocument,
        Item,
        PurchaseInvoice;

importPurchaseInvoiceDataAction 'Импортировать накладную' = ACTION CUSTOM 'lsfusion.erp.integration.universal.ImportPurchaseInvoiceActionProperty';

importTypeUserInvoice = DATA ImportType(UserInvoice);
nameImportTypeUserInvoice 'Тип импорта' (userInvoice) = nameImportType(importTypeUserInvoice(userInvoice));


originalInvoice 'Файл оригинала накладной'  = DATA CUSTOMFILE (Purchase.Invoice);

saveOriginalInvoice 'Загрузить файл оригинала накладной' (i) = ACTION LOADFILE originalInvoice(i);
openOriginalInvoice 'Просмотреть оригинал накладной' (i) = ACTION OPENFILE originalInvoice(i);

EXTEND FORM userInvoice
    PROPERTIES(i) importPurchaseInvoiceDataAction TODRAW d TOOLBAR
    PROPERTIES(i) nameImportTypeUserInvoice
    PROPERTIES(i) saveOriginalInvoice, openOriginalInvoice 
;

EXTEND DESIGN userInvoice{
    headerTabbedPane {
        NEW import {
            caption = 'Импорт';
            type = CONTAINERH;
            NEW universalImport {
                caption = 'Универсальный импорт';
                ADD PROPERTY(nameImportTypeUserInvoice);
                ADD PROPERTY(importPurchaseInvoiceDataAction);
            }
            NEW origin {
                caption = 'Оригинал накладной';
                ADD PROPERTY(saveOriginalInvoice);
                ADD PROPERTY(openOriginalInvoice);            
            }
        }
    }
}




