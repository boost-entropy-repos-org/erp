MODULE  MenuBy;

REQUIRE Menu;

//-----------------Печатные формы (выводятся на печать только два уровня групп)-----------------//

FORM menuPrint 'Меню'
    OBJECTS m = Menu FIXED PANEL
    PROPERTIES (m) nameStockMenu, numberMenu, seriesMenu, dateMenu, timeMenu,
                   nameCurrencyMenu, namePriceListTypeMenu, noteMenu, countMenuDetailMenu,
                   nameGroupTypeMenu

    OBJECTS g1=Group
    PROPERTIES READONLY nameG = nameGroup(g1)
    PROPERTIES(m,g1) positionNumberMenuGroup
    FILTERS groupTypeGroup(g1) == groupTypeMenu(m),
            g1 IS Group AND NOT parentGroup(g1)
    ORDER BY positionNumberMenuGroup(m,g1)
    FILTERGROUP inactive FILTER 'Активные' 'F5' activeGroup(g1) DEFAULT

    OBJECTS g2=Group
    PROPERTIES READONLY nameGr = nameGroup(g2)
    PROPERTIES(m,g2) positionNumberMenuGroup
    FILTERS groupTypeGroup(g2) == groupTypeMenu(m),
            parentGroup(g2) == g1
    ORDER BY positionNumberMenuGroup(m,g2)
    FILTERGROUP inactive1 FILTER 'Активные' 'F5' activeGroup(g2) DEFAULT

    OBJECTS d = MenuDetail
    PROPERTIES (d) READONLY idBarcodeSkuMenuDetail, nameSkuMenuDetail,
                   priceMenuDetail, compositionMenuDetail, productYieldMenuDetail
    PROPERTIES (d,g2) positionNumberMenuDetailGroup
    FILTERS hasParentDetailGroup(d,g2),
            menuMenuDetail(d) == m

    ORDER BY positionNumberMenuDetailGroup(d,g2)
;
printMenu 'Меню' (menu) = ACTION FORM menuPrint OBJECTS m = menu PRINT  IMAGE 'print.png' IN print;

EXTEND FORM menus
    PROPERTIES(m) FORCE PANEL printMenu
;
EXTEND DESIGN menus {
    printTab {
        ADD m.print;
    }
}








