MODULE ItemAlcohol;

REQUIRE ItemSize, SaleStatisticsBy;

NAMESPACE Item;


loadDefaultAlcoholGroupsBy 'Загрузить стандартные статистические группы' = ACTION () {

    EXEC loadDefaultStatisticGroupType('Оптовая торговля (алькоголь)', 'BYA', '112');

    EXEC loadDefaultStatisticGroup('BYA', ' ', 'ВСЕ', '1000', GroupStatic.statisticLiter, 10000);
    EXEC loadDefaultStatisticGroup('BYA','1000','Водка','1010',GroupStatic.statisticLiter,10000);
    EXEC loadDefaultStatisticGroup('BYA','1000','Ликеро-водочные изделия','1020',GroupStatic.statisticLiter,10000);
    EXEC loadDefaultStatisticGroup('BYA','1000','Виски','1030',GroupStatic.statisticLiter,10000);
    EXEC loadDefaultStatisticGroup('BYA','1000','Ром','1040',GroupStatic.statisticLiter,10000);        
    EXEC loadDefaultStatisticGroup('BYA','1000','Текила','1160',GroupStatic.statisticLiter,10000);
    EXEC loadDefaultStatisticGroup('BYA','1000','Вина полодовые','1060',GroupStatic.statisticLiter,10000);
    EXEC loadDefaultStatisticGroup('BYA','1000','Вина игристые (в том числе шампанские)','1090',GroupStatic.statisticLiter,10000);
    EXEC loadDefaultStatisticGroup('BYA','1000','Вина виноградные','1100',GroupStatic.statisticLiter,10000);   
    EXEC loadDefaultStatisticGroup('BYA','1000','Коньяки','1130',GroupStatic.statisticLiter,10000);    
    EXEC loadDefaultStatisticGroup('BYA','1000','Бренди','1140',GroupStatic.statisticLiter,10000);    
    EXEC loadDefaultStatisticGroup('BYA','1000','Другие алкогольные напитки','1150',GroupStatic.statisticLiter,10000);
}
loadDefaultStatisticGroups () += ACTION loadDefaultAlcoholGroupsBy();

//--
CLASS AlcoholDirectionType 'Тип движения алкоголя' { 
    income 'Поступление',
    outcome 'Расход (только опт)'    
}
TABLE alcoholDirectionType (AlcoholDirectionType);

numberAlcoholDirectionType 'Номер типа движения алкоголя' = DATA INTEGER (AlcoholDirectionType);

onStarted() += ACTION (){
    numberAlcoholDirectionType(d) <- 3 WHERE d == AlcoholDirectionType.income; 
    numberAlcoholDirectionType(d) <- 4 WHERE d == AlcoholDirectionType.outcome; 

}
FORM alcoholDirectionTypies 'Типы приобретения алкоголя'
    OBJECTS d = AlcoholDirectionType
    PROPERTIES(d) READONLY staticCaption, numberAlcoholDirectionType
    ORDER BY numberAlcoholDirectionType(d)
    DIALOG AlcoholDirectionType OBJECT d
;
//--
CLASS AlcoholIncomeType 'Тип приобретения алкоголя' { 
    internal 'Приобретено в РБ',
    external 'Импортировано',
    other 'Прочее поступление'
}
TABLE alcoholIncomeType (AlcoholIncomeType);

numberAlcoholIncomeType 'Номер типа приобретения алкоголя' = DATA INTEGER (AlcoholIncomeType);

onStarted() += ACTION (){
    numberAlcoholIncomeType(d) <- 1 WHERE d == AlcoholIncomeType.internal; 
    numberAlcoholIncomeType(d) <- 2 WHERE d == AlcoholIncomeType.external; 
    numberAlcoholIncomeType(d) <- 3 WHERE d == AlcoholIncomeType.other; 

}
FORM alcoholIncomeTypies 'Типы приобретения алкоголя'
    OBJECTS d = AlcoholIncomeType
    PROPERTIES(d) READONLY staticCaption, numberAlcoholIncomeType
    ORDER BY numberAlcoholIncomeType(d)
    DIALOG AlcoholIncomeType OBJECT d
;
//--
CLASS AlcoholSupplierType 'Тип поставщика алкоголя' { 
    importer 'От импортера',
    manufacturer 'От изготовителя',
    wholesale 'Приход от оптоваой торговли'
}
TABLE alcoholSupplierType (AlcoholSupplierType);

alcoholSupplierTypeLegalEntityItem 'Тип поставщика алкоголя' = DATA AlcoholSupplierType (LegalEntity, Item);
captionAlcoholSupplierTypeLegalEntityItem 'Тип поставщика алкоголя' (legalEntity, item) = staticCaption(alcoholSupplierTypeLegalEntityItem(legalEntity, item));

numberAlcoholSupplierType 'Номер типа поставщика алкоголя' = DATA INTEGER (AlcoholSupplierType);
alcoholSupplierTypeNumber (number) = GROUP AGGR alcoholSupplierType BY numberAlcoholSupplierType(alcoholSupplierType);

onStarted() += ACTION (){
    numberAlcoholSupplierType(d) <- 1 WHERE d == AlcoholSupplierType.manufacturer; 
    numberAlcoholSupplierType(d) <- 2 WHERE d == AlcoholSupplierType.importer; 
    numberAlcoholSupplierType(d) <- 3 WHERE d == AlcoholSupplierType.wholesale; 

}
FORM alcoholSupplierTypies 'Типы поставщиков алкоголя'
    OBJECTS d = AlcoholSupplierType
    PROPERTIES(d) READONLY staticCaption, numberAlcoholSupplierType
    ORDER BY numberAlcoholSupplierType(d)
    DIALOG AlcoholSupplierType OBJECT d
;







