MODULE ExportExcel;

REQUIRE System,
        Bank,
        Dimension,
        GeneralLedger,
        Item,
        LegalEntity,
        PriceListCalc,
        PurchaseInvoice,
        TaxItem,
        PurchaseInvoiceCharge,
        PurchaseCertificate,
        WareItem;

//---------------------------------------------- Экспорт данных -----------------------------------------------------//

GROUP exportExcel 'Экспорт в Excel' : public;

exportBanksAction 'Экспортировать банки' = CUSTOM 'lsfusion.erp.region.by.integration.excel.ExportExcelBanksActionProperty' () IN exportExcel;
exportGeneralLedgerAction 'Экспортировать проводки' = CUSTOM 'lsfusion.erp.region.by.integration.excel.ExportExcelGeneralLedgerActionProperty' (DATE, DATE) IN exportExcel;
exportLegalEntitiesAction 'Экспортировать организации' = CUSTOM 'lsfusion.erp.region.by.integration.excel.ExportExcelLegalEntitiesActionProperty' () IN exportExcel;
exportItemsAction 'Экспортировать товары' = CUSTOM 'lsfusion.erp.region.by.integration.excel.ExportExcelItemsActionProperty' () IN exportExcel;
exportUserInvoicesAction 'Экспортировать остатки' = CUSTOM 'lsfusion.erp.region.by.integration.excel.ExportExcelUserInvoicesActionProperty' (DATE, DATE) IN exportExcel;

exportAllAction 'Экспортировать всё' = CUSTOM 'lsfusion.erp.region.by.integration.excel.ExportExcelAllActionProperty' (DATE, DATE) IN exportExcel;

EXTEND FORM integrationData
    OBJECTS dates = (dFrom = DATE, dTo = DATE) PANEL
    PROPERTIES objFrom = VALUE(dFrom), objTo = VALUE(dTo)
    PROPERTIES() exportBanksAction, exportLegalEntitiesAction, exportItemsAction
    PROPERTIES(dFrom, dTo) exportGeneralLedgerAction, exportUserInvoicesAction, exportAllAction
;
DESIGN integrationData {
    pane {
        NEW exportExcel {
            type = CONTAINERV;
            caption = 'Экспорт в Excel';
            MOVE BOX(dates) {
                caption = 'Параметры экспорта';
                type = CONTAINERH;
                PROPERTY(objFrom) {
                    caption = 'Дата (с)';
                }
                PROPERTY(objTo) {
                    caption = 'Дата (по)';
                }
            }
        MOVE PROPERTY (exportBanksAction());
        MOVE PROPERTY (exportGeneralLedgerAction(dFrom,dTo));
        MOVE PROPERTY (exportUserInvoicesAction(dFrom,dTo));
        MOVE PROPERTY (exportLegalEntitiesAction());
        MOVE PROPERTY (exportItemsAction());
        MOVE PROPERTY (exportAllAction(dFrom,dTo));
        }
    }
}
