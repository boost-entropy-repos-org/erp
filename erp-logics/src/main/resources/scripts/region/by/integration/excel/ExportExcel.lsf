MODULE ExportExcel;

REQUIRE System,
        Bank,
        Dimension,
        GeneralLedger,
        Item,
        LegalEntity,
        PriceListCalc,
        PurchaseInvoice,
        TaxItem,
        PurchaseInvoiceCharge,
        PurchaseCertificate,
        WareItem;

//---------------------------------------------- Экспорт данных -----------------------------------------------------//

GROUP exportExcel 'Экспорт в Excel' : public;

exportBanksAction 'Экспортировать банки' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ExportExcelBanksActionProperty' IN exportExcel;
exportGeneralLedgerAction 'Экспортировать проводки' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ExportExcelGeneralLedgerActionProperty' IN exportExcel;
exportLegalEntitiesAction 'Экспортировать организации' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ExportExcelLegalEntitiesActionProperty' IN exportExcel;
exportItemsAction 'Экспортировать товары' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ExportExcelItemsActionProperty' IN exportExcel;
exportUserInvoicesAction 'Экспортировать остатки' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ExportExcelUserInvoicesActionProperty' IN exportExcel;

exportAllAction 'Экспортировать всё' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ExportExcelAllActionProperty' IN exportExcel;

EXTEND FORM integrationData
    OBJECTS dates = (dFrom = DATE, dTo = DATE) FIXED PANEL
    PROPERTIES objFrom = OBJVALUE(dFrom), objTo = OBJVALUE(dTo)
    PROPERTIES() exportBanksAction, exportLegalEntitiesAction, exportItemsAction
    PROPERTIES(dFrom, dTo) exportGeneralLedgerAction, exportUserInvoicesAction, exportAllAction
;
EXTEND DESIGN integrationData {
    pane {
        NEW exportExcel {
            type = CONTAINERV;
            caption = 'Экспорт в Excel';
            ADD dates.box {
                caption = 'Параметры экспорта';
                type = CONTAINERH;
                PROPERTY(objFrom) {
                    caption = 'Дата (с)';
                }
                PROPERTY(objTo) {
                    caption = 'Дата (по)';
                }
            }
        ADD PROPERTY (exportBanksAction());
        ADD PROPERTY (exportGeneralLedgerAction(dFrom,dTo));
        ADD PROPERTY (exportUserInvoicesAction(dFrom,dTo));
        ADD PROPERTY (exportLegalEntitiesAction());
        ADD PROPERTY (exportItemsAction());
        ADD PROPERTY (exportAllAction(dFrom,dTo));
        }
    }
}
