MODULE ImportExcel;

REQUIRE System, 
        Bank,
        Country,
        Item,
        LegalEntity,
        PurchaseInvoice,
        PurchaseShipment,
        StockContract,
        TaxItem,
        Warehouse;


//---------------------------------------------- Импорт данных -----------------------------------------------------//

GROUP excelUOMs 'Импорт единиц измерения' : public;
GROUP excelItems 'Импорт товаров' : public;
GROUP excelGroupItems 'Импорт групп товаров' : public;
GROUP excelBanks 'Импорт банков' : public;
GROUP excelLegalEntities 'Импорт организаций' : public;
GROUP excelStores 'Импорт магазинов' : public;
GROUP excelDepartmentStores 'Импорт отделов магазинов' : public;
GROUP excelWarehouses 'Импорт складов' : public;
GROUP excelContracts 'Импорт контрактов' : public;
GROUP excelUserInvoices 'Импорт документов прихода' : public;
GROUP excelAll 'Импорт всего' : public;

createTemplateItemsAction 'Создать шаблон для импорта товаров' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateItemsActionProperty' () IN excelItems;
importItemsOnlyEAN 'Штрихкоды только EAN' = DATA BOOLEAN () IN excelItems;
importItemsAction 'Импортировать товары' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelItemsActionProperty' () IN excelItems;

createTemplateUOMsAction 'Создать шаблон для импорта единиц измерения' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateUOMsActionProperty' () IN excelUOMs;
importUOMsAction 'Импортировать единицы измерения' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelUOMsActionProperty' () IN excelUOMs;

createTemplateGroupItemsAction 'Создать шаблон для импорта групп товаров' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateGroupItemsActionProperty' () IN excelGroupItems;
importGroupItemsAction 'Импортировать группы товаров' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelGroupItemsActionProperty' () IN excelGroupItems;

createTemplateBanksAction 'Создать шаблон для импорта банков' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateBanksActionProperty' () IN excelBanks;
importBanksAction 'Импортировать банки' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelBanksActionProperty' () IN excelBanks;

createTemplateLegalEntitiesAction 'Создать шаблон для импорта организаций' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateLegalEntitiesActionProperty' () IN excelLegalEntities;
importLegalEntitiesAction 'Импортировать организации' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelLegalEntitiesActionProperty' () IN excelLegalEntities;

createTemplateStoresAction 'Создать шаблон для импорта магазинов' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateStoresActionProperty' () IN excelStores;
importStoresAction 'Импортировать магазины' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelStoresActionProperty' () IN excelStores;

createTemplateDepartmentStoresAction 'Создать шаблон для импорта отделов магазинов' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateDepartmentStoresActionProperty' () IN excelDepartmentStores;
importDepartmentStoresAction 'Импортировать отделы магазинов' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelDepartmentStoresActionProperty' () IN excelDepartmentStores;

createTemplateWarehousesAction 'Создать шаблон для импорта складов' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateWarehousesActionProperty' () IN excelWarehouses;
importWarehousesAction 'Импортировать склады' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelWarehousesActionProperty' () IN excelWarehouses;

createTemplateContractsAction 'Создать шаблон для импорта договоров' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateContractsActionProperty' () IN excelContracts;
importContractsAction 'Импортировать договоры' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelContractsActionProperty' () IN excelContracts;

createTemplateUserInvoicesAction 'Создать шаблон для импорта остатков' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateUserInvoicesActionProperty' () IN excelUserInvoices;
importUserInvoicesAction 'Импортировать остатки' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelUserInvoicesActionProperty' () IN excelUserInvoices;

createTemplateAllAction 'Создать все шаблоны' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateAllActionProperty' () IN excelAll;
importAllAction 'Импортировать всё' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelAllActionProperty' () IN excelAll;
skipKeysExcel 'Игнорировать несуществующие коды' = DATA BOOLEAN() IN excelAll;

EXTEND FORM integrationData
    PROPERTIES() createTemplateAllAction, importAllAction, skipKeysExcel,
    createTemplateUOMsAction, importUOMsAction,
    createTemplateItemsAction, importItemsAction, importItemsOnlyEAN, createTemplateGroupItemsAction, importGroupItemsAction,
    createTemplateBanksAction, importBanksAction, createTemplateLegalEntitiesAction, importLegalEntitiesAction,
    createTemplateStoresAction, importStoresAction, createTemplateDepartmentStoresAction, importDepartmentStoresAction,
    createTemplateWarehousesAction, importWarehousesAction, createTemplateContractsAction, importContractsAction,
    createTemplateUserInvoicesAction, importUserInvoicesAction
;
DESIGN integrationData {
    pane {
        NEW importExcel {
            type = CONTAINERV;
            caption = 'Импорт из Excel';
            MOVE NOGROUP.excelAll {
                type = CONTAINERH;
            };
            MOVE NOGROUP.excelGroupItems {
                type = CONTAINERH;
            };
            MOVE NOGROUP.excelUOMs {
                type = CONTAINERH;
            };
            MOVE NOGROUP.excelItems {
                type = CONTAINERH;
            };
            MOVE NOGROUP.excelBanks {
                type = CONTAINERH;
            };
            MOVE NOGROUP.excelLegalEntities {
                type = CONTAINERH;
            };
            MOVE NOGROUP.excelStores{
                type = CONTAINERH;
            };
            MOVE NOGROUP.excelDepartmentStores{
                type = CONTAINERH;
            };
            MOVE NOGROUP.excelWarehouses{
                type = CONTAINERH;
            };
            MOVE NOGROUP.excelContracts{
                type = CONTAINERH;
            };
            MOVE NOGROUP.excelUserInvoices{
                type = CONTAINERH;
            };
        }
    }
}
