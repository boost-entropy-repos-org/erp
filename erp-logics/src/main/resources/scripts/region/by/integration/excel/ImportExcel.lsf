MODULE ImportExcel;

REQUIRE Import;


//---------------------------------------------- Импорт данных -----------------------------------------------------//

GROUP excelUOMsGroup 'Импорт единиц измерения' : public;
GROUP excelItemsGroup 'Импорт товаров' : public;
GROUP excelGroupItemsGroup 'Импорт групп товаров' : public;
GROUP excelBanksGroup 'Импорт банков' : public;
GROUP excelLegalEntitiesGroup 'Импорт организаций' : public;
GROUP excelStoresGroup 'Импорт магазинов' : public;
GROUP excelDepartmentStoresGroup 'Импорт отделов магазинов' : public;
GROUP excelWarehousesGroup 'Импорт складов' : public;
GROUP excelContractsGroup 'Импорт контрактов' : public;
GROUP excelUserInvoicesGroup 'Импорт документов прихода' : public;
GROUP excelAllGroup 'Импорт всего' : public;

createTemplateItemsAction 'Создать шаблон для импорта товаров' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateItemsActionProperty' IN excelItemsGroup;
importItemsAction 'Импортировать товары' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelItemsActionProperty' IN excelItemsGroup;

createTemplateUOMsAction 'Создать шаблон для импорта единиц измерения' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateUOMsActionProperty' IN excelUOMsGroup;
importUOMsAction 'Импортировать единицы измерения' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelUOMsActionProperty' IN excelUOMsGroup;

createTemplateGroupItemsAction 'Создать шаблон для импорта групп товаров' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateGroupItemsActionProperty' IN excelGroupItemsGroup;
importGroupItemsAction 'Импортировать группы товаров' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelGroupItemsActionProperty' IN excelGroupItemsGroup;

createTemplateBanksAction 'Создать шаблон для импорта банков' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateBanksActionProperty' IN excelBanksGroup;
importBanksAction 'Импортировать банки' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelBanksActionProperty' IN excelBanksGroup;

createTemplateLegalEntitiesAction 'Создать шаблон для импорта организаций' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateLegalEntitiesActionProperty' IN excelLegalEntitiesGroup;
importLegalEntitiesAction 'Импортировать организации' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelLegalEntitiesActionProperty' IN excelLegalEntitiesGroup;

createTemplateStoresAction 'Создать шаблон для импорта магазинов' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateStoresActionProperty' IN excelStoresGroup;
importStoresAction 'Импортировать магазины' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelStoresActionProperty' IN excelStoresGroup;

createTemplateDepartmentStoresAction 'Создать шаблон для импорта отделов магазинов' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateDepartmentStoresActionProperty' IN excelDepartmentStoresGroup;
importDepartmentStoresAction 'Импортировать отделы магазинов' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelDepartmentStoresActionProperty' IN excelDepartmentStoresGroup;

createTemplateWarehousesAction 'Создать шаблон для импорта складов' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateWarehousesActionProperty' IN excelWarehousesGroup;
importWarehousesAction 'Импортировать склады' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelWarehousesActionProperty' IN excelWarehousesGroup;

createTemplateContractsAction 'Создать шаблон для импорта договоров' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateContractsActionProperty' IN excelContractsGroup;
importContractsAction 'Импортировать договоры' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelContractsActionProperty' IN excelContractsGroup;

createTemplateUserInvoicesAction 'Создать шаблон для импорта остатков' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateUserInvoicesActionProperty' IN excelUserInvoicesGroup;
importUserInvoicesAction 'Импортировать остатки' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelUserInvoicesActionProperty' IN excelUserInvoicesGroup;

createTemplateAllAction 'Создать все шаблоны' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateAllActionProperty' IN excelAllGroup;
importAllAction 'Импортировать всё' = ACTION CUSTOM 'lsfusion.erp.region.by.integration.excel.ImportExcelAllActionProperty' IN excelAllGroup;
skipKeysExcel 'Игнорировать несуществующие коды' = DATA BOOLEAN() IN excelAllGroup;
withoutRecalcExcel 'Не пересчитывать аггрегации' = DATA BOOLEAN() IN excelAllGroup;

EXTEND FORM integrationData
    PROPERTIES() createTemplateAllAction, importAllAction, skipKeysExcel, withoutRecalcExcel,
    createTemplateUOMsAction, importUOMsAction,
    createTemplateItemsAction, importItemsAction, createTemplateGroupItemsAction, importGroupItemsAction,
    createTemplateBanksAction, importBanksAction, createTemplateLegalEntitiesAction, importLegalEntitiesAction,
    createTemplateStoresAction, importStoresAction, createTemplateDepartmentStoresAction, importDepartmentStoresAction,
    createTemplateWarehousesAction, importWarehousesAction, createTemplateContractsAction, importContractsAction,
    createTemplateUserInvoicesAction, importUserInvoicesAction
;
EXTEND DESIGN integrationData {
    pane {
        NEW importExcel {
            type = CONTAINERV;
            caption = 'Импорт из Excel';
            ADD NOGROUP.excelAllGroup {
                type = CONTAINERH;
            };
            ADD NOGROUP.excelGroupItemsGroup {
                type = CONTAINERH;
            };
            ADD NOGROUP.excelUOMsGroup {
                type = CONTAINERH;
            };
            ADD NOGROUP.excelItemsGroup {
                type = CONTAINERH;
            };
            ADD NOGROUP.excelBanksGroup {
                type = CONTAINERH;
            };
            ADD NOGROUP.excelLegalEntitiesGroup {
                type = CONTAINERH;
            };
            ADD NOGROUP.excelStoresGroup{
                type = CONTAINERH;
            };
            ADD NOGROUP.excelDepartmentStoresGroup{
                type = CONTAINERH;
            };
            ADD NOGROUP.excelWarehousesGroup{
                type = CONTAINERH;
            };
            ADD NOGROUP.excelContractsGroup{
                type = CONTAINERH;
            };
            ADD NOGROUP.excelUserInvoicesGroup{
                type = CONTAINERH;
            };
        }
    }
}
