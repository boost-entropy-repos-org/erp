MODULE WareItem;

REQUIRE System, Item, Ware;

NAMESPACE Item;

@defineObjectItemAttribute(ware, Ware, name, 'Посуда', itemBase);
@defineUniteAttributeItemWithoutExtendForm(ware, nameWare, 'посуда', 'посуда', item);

EXTEND FORM attributesItem
    TREE treeGroups wareGroup=WareGroup PARENT parentWareGroup
    PROPERTIES READONLY nameWareGroup(wareGroup)
    ORDER BY nameWareGroup(wareGroup)

    OBJECTS ware=Ware
    PROPERTIES inWare(ware)    
    PROPERTIES(ware) READONLY nameWare, idWare SHOWIF showIDs(), canonicalNameWareGroupWare, warePrice, numberRangeRangeWare, valueCurrentRateRangeWare
    PROPERTIES(ware) ADDFORM, EDITFORM, DELETE FORCE PANEL TOOLBAR        
    ORDER BY nameWare(ware)
    PROPERTIES replaceWare(ware) TODRAW ware FORCE PANEL TOOLBAR    
    FILTERS isParentWareGroupWare(wareGroup, ware)
    
    OBJECTS wareItem = Item
    PROPERTIES(wareItem) READONLY idBarcodeSku, nameSku, idSku, idSkuGroupSku
    PROPERTIES(wareItem) nameWareItem, editSku FORCE PANEL
    FILTERS wareItem(wareItem) == ware    

;

DESIGN attributesItem{
    tabContainer{
        NEW wareContainer{
            caption = 'Посуда';
            fill = 1;
            type = SPLITH;
            ADD treeGroups.tree.box {
                caption = 'Группы посуды';
            }
            NEW rw {
                fill = 3;
                type = SPLITV;
                ADD ware.box {                   
                    ware.grid {
                        defaultComponent = TRUE;
                    }
                }
                ADD wareItem.box;
            }
        }
    }
}
@defineObjectItemAttributeBatch (ware, nameWare, 'Посуда');
@implementItemAttribute(nameWare, 'Посуда', String, itemBase);

@defineItemDefaultValue(ware, 'Посуда', Ware, nameWare);
@defineItemFilterValue(ware, 'Посуда', w);

@defineItemExtractObjectAttribute(ware, nameWare, wareName);

inWareItem 'Товар в посуде' (item) = item IS Item AND wareItem(item);

overCopyItem(s, d) += ACTION (s, d) {
    ASSIGN wareItem(d) <- wareItem(s);
}

