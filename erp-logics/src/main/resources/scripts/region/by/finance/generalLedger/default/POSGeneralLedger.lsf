MODULE POSGeneralLedger;

REQUIRE GeneralLedger, POS, DimensionStock;

NAMESPACE POS;
//------------------- Реализация через кассы --------------------//

EXTEND CLASS Receipt : GeneralLedger.GLDocument;
nameGLDocument(document) += descriptionReceipt(document);
numberGLDocument(document) += STRING[10](numberReceipt(document));
dateTimeGLDocument(document) += dateTimeReceipt(document);
//editGLDocument (GLDocument)+= ACTION editInvoice(GLDocument);

//------------------- Розничная сумма --------------------//
companyReceipt (receipt) = legalEntityStore(storeDepartmentStore(departmentStoreReceipt(receipt)));
@defineGeneralLedgerAggregation (receipt,                     // основание
                                 POS,                         // идентификатор
                                 company,                     // компания
                                 sumReceiptDetail,     // сумма
                                 description,                 // описание
                                 '90.1',                      // дебет
                                 '41.2',                      // кредит
                                 'by_default'                 // идентификатор плана счетов
                                 );
creditGeneralLedgerDimensionType(generalLedger,dimensionType) += WHEN CLASS(receiptPOSGeneralLedger(generalLedger)) AND dimensionType == DimensionType.stock THEN departmentStoreReceipt(receiptPOSGeneralLedger(generalLedger));
idOperationGeneralLedger(l) += '51' IF l IS POSGeneralLedger;