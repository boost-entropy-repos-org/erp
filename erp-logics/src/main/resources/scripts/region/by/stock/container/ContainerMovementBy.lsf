MODULE ContainerMovementBy;

REQUIRE ContainerMovement;

NAMESPACE ContainerMovement;

FORM printContainerMovementBy 'Отчет по таре'

    OBJECTS params = (dFrom = DATE, dTo = DATE) FIXED PANEL
    PROPERTIES objFrom = OBJVALUE(dFrom), objTo = OBJVALUE(dTo)

    OBJECTS dep = DepartmentStore  FIXED PANEL
    PROPERTIES(dep) SELECTOR nameDepartmentStore, nameStoreDepartmentStore, nameLegalEntityDepartmentStore

    OBJECTS bt=Batch

    PROPERTIES READONLY accountSumContainerStockDateFrom(dep, dFrom), accountSumContainerStockDateTo(dep, dTo)
    PROPERTIES(bt) READONLY idBarcodeSkuBatch, nameSkuBatch, costBatch
    PROPERTIES(bt, dep, dFrom) READONLY balanceBBatchStockDate, accountSumBBatchStockDate
    PROPERTIES(bt, dep, dTo) READONLY balanceABatchStockDate, accountSumABatchStockDate
    PROPERTIES(bt, dep, dFrom, dTo) READONLY costInBalanceBatchStockDateFromTo, costSumInBalanceBatchStockDateFromTo,
               costOutBalanceBatchStockDateFromTo, costSumOutBalanceBatchStockDateFromTo

    FILTERS isPostedBatch(bt),
            isContainerBatch(bt),
            overMovementContainerBatchStockDateFromTo(bt, dep, dFrom, dTo)!=0
;

printContainerMovementBy 'Распечатать' (dateFrom, dateTo, departmentStore) =
    ACTION FORM printContainerMovementBy OBJECTS dFrom = dateFrom, dTo = dateTo, dep = departmentStore PRINT  IMAGE 'print.png' IN print;

EXTEND FORM containerMovement

    PROPERTIES printContainerMovementBy(dFrom, dTo, dep) TODRAW params FORCE PANEL
;

DESIGN containerMovement{

    print {
        ADD PROPERTY(printContainerMovementBy(dFrom,dTo,dep));
    }
}