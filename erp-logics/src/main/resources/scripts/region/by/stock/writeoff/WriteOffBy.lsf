MODULE WriteOffBy;

REQUIRE WriteOff, LegalEntityBy;

NAMESPACE WriteOff;

UNPLegalEntityStock 'УНП' (WriteOff writeOff) = UNP(legalEntityStock(writeOff));

// --------------------------- Печатная форма ---------------------------------

FORM printWriteOffBy 'Акт списания'
    OBJECTS w=WriteOff FIXED PANEL
    PROPERTIES (w)  SELECTOR number, series, fullNameStock, nameStock,
                   date, time, nameReason, note, countWriteOffDetail, quantityWriteOffDetail,
                   sumWriteOffDetail,
                   nameLegalEntityStock, addressLegalEntity, nameWriteOffCommittee,
                   nameEmployeeWriteOffCommittee, writeOffCommittee, UNPLegalEntityStock

    OBJECTS d=WriteOffDetail
    PROPERTIES (d) READONLY index, idBarcodeSku, nameSku, shortNameUOMSku, nameBatch,
                   quantity, price, sum

    OBJECTS e=Employee
    PROPERTIES(e) SELECTOR   name[Contact], namePosition

    FILTERS in(w, d),
            inWriteOffCommittee(w, e)
;

printBy 'Акт списания' (WriteOff writeOff) = ACTION PRINT printWriteOffBy OBJECTS w = writeOff   IMAGE 'print.png' IN print;
printByXLS 'Акт списания (xls)' (WriteOff writeOff) = ACTION PRINT printWriteOffBy OBJECTS w = writeOff XLS IMAGE 'print.png' IN print;

EXTEND FORM writeOffs

    PROPERTIES (w) FORCE PANEL printBy, printByXLS
;

DESIGN writeOffs{
    printContainer{
        MOVE PROPERTY(printBy(w));
        MOVE PROPERTY(printByXLS(w));
    }
}