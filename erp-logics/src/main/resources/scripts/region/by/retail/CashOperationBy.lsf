MODULE CashOperationBy;

REQUIRE CashOperation;

NAMESPACE CashOperation;

FORM printIncomeCashOrderBy 'ПКО'

    OBJECTS i = IncomeCashOrder FIXED PANEL
    PROPERTIES(i) READONLY number, date, time, nameLegalEntity,
                           nameDepartmentStore, sumCash, basis

;

FORM printOutcomeCashOrderBy 'РКО'

    OBJECTS o = OutcomeCashOrder FIXED PANEL
    PROPERTIES(o) READONLY number, date, time, nameLegalEntity,
                           nameDepartmentStore, sumCash, basis

;

printBy 'Распечатать' (IncomeCashOrder incomeCashOrder) = ACTION {
    FORM printIncomeCashOrderBy OBJECTS i = incomeCashOrder PRINT;
    ASSIGN isPrinted(incomeCashOrder) <- TRUE;
    EXEC apply();
} CONFIRM;

printAllIncomeCashOrderBy 'Распечатать все непечатанные' = ACTION(DATE date1, DATE date2) {

    FOR isNotPrinted(IncomeCashOrder incomeCashOrder) AND
        date(incomeCashOrder) >= date1 AND
        date(incomeCashOrder) <= date2 DO {
        FORM printIncomeCashOrderBy OBJECTS i = incomeCashOrder PRINT;
        ASSIGN isPrinted(incomeCashOrder) <- TRUE;
        EXEC apply();
    }

} CONFIRM TOOLBAR;

printBy 'Распечатать' (OutcomeCashOrder outcomeCashOrder) = ACTION {
    FORM printOutcomeCashOrderBy OBJECTS o = outcomeCashOrder PRINT;
    ASSIGN isPrinted(outcomeCashOrder) <- TRUE;
    EXEC apply();
} CONFIRM;

printAllOutcomeCashOrderBy 'Распечатать все непечатанные' = ACTION(DATE date1, DATE date2) {

    FOR isNotPrinted(OutcomeCashOrder outcomeCashOrder) AND
        date(outcomeCashOrder) >= date1 AND
        date(outcomeCashOrder) <= date2 DO {
        FORM printOutcomeCashOrderBy OBJECTS o = outcomeCashOrder PRINT;
        ASSIGN isPrinted(outcomeCashOrder) <- TRUE;
        EXEC apply();
    }

} CONFIRM TOOLBAR;
