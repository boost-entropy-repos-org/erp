MODULE NativeMachinery;

REQUIRE MachineryPriceTransaction,
        CashRegister, CashRegisterPriceTransaction, CashRegisterItem; //  to delete

NAMESPACE Machinery;

sendDeltaRests ABSTRACT LIST (MachineryPriceTransaction);

sendMachineryPriceTransaction ABSTRACT LIST (MachineryPriceTransaction);

receiveGroupMachinery ABSTRACT LIST (GroupMachinery);


sendMachineryPriceTransactions 'Загрузка прайса в оборудование (native)' () {
    FOR MachineryPriceTransaction t IS MachineryPriceTransaction AND NOT succeeded(t) AND NOT canceled(t) AND NOT dateTimeProcessing(t) DO
        sendMachineryPriceTransaction(t);
}

sendRests 'Загрузка остатков в оборудование' () {
    FOR MachineryPriceTransaction t IS MachineryPriceTransaction AND succeeded(t) AND NOT canceled(t) AND left(handlerModel(groupMachinery(t)), 4) = 'lsf.' DO {
        sendDeltaRests(t);
    }
}

receiveGroupsMachinery 'Получение данных из оборудования (native)' () {
    FOR GroupMachinery g IS GroupMachinery AND left(handlerModel(g), 4) = 'lsf.' DO
        receiveGroupMachinery(g);
}

//EXTEND FORM machineryPriceTransactions PROPERTIES sendMachineryPriceTransactions(), receiveGroupsMachinery(), sendRests();