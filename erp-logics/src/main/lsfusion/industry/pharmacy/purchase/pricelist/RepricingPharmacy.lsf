MODULE RepricingPharmacy;

REQUIRE RepricingPriceDivider, ItemPharmacy, PurchaseInvoicePharmacy;

NAMESPACE Repricing;


blisterAmount 'Кол-во блистеров (в ед.)' (RepricingDetail detail) = blisterAmount(batch(detail)) CHARWIDTH 3;   

//blisterAmount 'Кол-во блистеров (в ед.)' = ABSTRACT INTEGER(RepricingDetail) CHARWIDTH 3;    
//blisterAmount 'Кол-во блистеров (в ед.)' = DATA INTEGER(UserRepricingDetail) CHARWIDTH 3;
//
//blisterAmount (UserRepricingDetail detail) += blisterAmount(detail);
//         
//setBlisterAmount (UserRepricingDetail detail)  { 
//    INPUT i = INTEGER DO  
//        blisterAmount(detail) <- i IF i != 0;
//}         

EXTEND FORM userRepricing
    PROPERTIES (d) blisterAmount AFTER quantity(d)    
;

EXTEND FORM repricings
    PROPERTIES (d) READONLY blisterAmount AFTER quantity(d)    
;
//          
//WHEN LOCAL FORMS userRepricing GOAFTER sku[UserRepricingDetail] CHANGED(sku(UserRepricingDetail detail)) DO {
//    blisterAmount(detail) <- blisterAmount(sku(detail));    
//} 
//          

priceDivider(UserRepricingDetail detail) += blisterAmount(batch(detail));
