MODULE ImportExcel;

REQUIRE System, 
        Bank,
        Country,
        Item,
        LegalEntity,
        PurchaseInvoice,
        PurchaseShipment,
        StockContract,
        TaxItem,
        Warehouse;


//---------------------------------------------- Импорт данных -----------------------------------------------------//

GROUP excelUOMs 'Импорт единиц измерения' : public;
GROUP excelItems 'Импорт товаров' : public;
GROUP excelGroupItems 'Импорт групп товаров' : public;
GROUP excelBanks 'Импорт банков' : public;
GROUP excelLegalEntities 'Импорт организаций' : public;
GROUP excelStores 'Импорт магазинов' : public;
GROUP excelDepartmentStores 'Импорт отделов магазинов' : public;
GROUP excelWarehouses 'Импорт складов' : public;
GROUP excelContracts 'Импорт контрактов' : public;
GROUP excelUserInvoices 'Импорт документов прихода' : public;
GROUP excelAll 'Импорт всего' : public;

createTemplateItemsAction 'Создать шаблон для импорта товаров'  INTERNAL  'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateItemsActionProperty' () IN excelItems;
importItemsOnlyEAN 'Штрихкоды только EAN' = DATA BOOLEAN () IN excelItems;
importItemsAction 'Импортировать товары'  INTERNAL  'lsfusion.erp.region.by.integration.excel.ImportExcelItemsActionProperty' () IN excelItems;

createTemplateUOMsAction 'Создать шаблон для импорта единиц измерения'  INTERNAL  'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateUOMsActionProperty' () IN excelUOMs;
importUOMsAction 'Импортировать единицы измерения'  INTERNAL  'lsfusion.erp.region.by.integration.excel.ImportExcelUOMsActionProperty' () IN excelUOMs;

createTemplateGroupItemsAction 'Создать шаблон для импорта групп товаров'  INTERNAL  'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateGroupItemsActionProperty' () IN excelGroupItems;
importGroupItemsAction 'Импортировать группы товаров'  INTERNAL  'lsfusion.erp.region.by.integration.excel.ImportExcelGroupItemsActionProperty' () IN excelGroupItems;

createTemplateBanksAction 'Создать шаблон для импорта банков'  INTERNAL  'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateBanksActionProperty' () IN excelBanks;
importBanksAction 'Импортировать банки'  INTERNAL  'lsfusion.erp.region.by.integration.excel.ImportExcelBanksActionProperty' () IN excelBanks;

createTemplateLegalEntitiesAction 'Создать шаблон для импорта организаций'  INTERNAL  'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateLegalEntitiesActionProperty' () IN excelLegalEntities;
importLegalEntitiesAction 'Импортировать организации'  INTERNAL  'lsfusion.erp.region.by.integration.excel.ImportExcelLegalEntitiesActionProperty' () IN excelLegalEntities;

createTemplateStoresAction 'Создать шаблон для импорта магазинов'  INTERNAL  'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateStoresActionProperty' () IN excelStores;
importStoresAction 'Импортировать магазины'  INTERNAL  'lsfusion.erp.region.by.integration.excel.ImportExcelStoresActionProperty' () IN excelStores;

createTemplateDepartmentStoresAction 'Создать шаблон для импорта отделов магазинов'  INTERNAL  'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateDepartmentStoresActionProperty' () IN excelDepartmentStores;
importDepartmentStoresAction 'Импортировать отделы магазинов'  INTERNAL  'lsfusion.erp.region.by.integration.excel.ImportExcelDepartmentStoresActionProperty' () IN excelDepartmentStores;

createTemplateWarehousesAction 'Создать шаблон для импорта складов'  INTERNAL  'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateWarehousesActionProperty' () IN excelWarehouses;
importWarehousesAction 'Импортировать склады'  INTERNAL  'lsfusion.erp.region.by.integration.excel.ImportExcelWarehousesActionProperty' () IN excelWarehouses;

createTemplateContractsAction 'Создать шаблон для импорта договоров'  INTERNAL  'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateContractsActionProperty' () IN excelContracts;
importContractsAction 'Импортировать договоры'  INTERNAL  'lsfusion.erp.region.by.integration.excel.ImportExcelContractsActionProperty' () IN excelContracts;

createTemplateUserInvoicesAction 'Создать шаблон для импорта остатков'  INTERNAL  'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateUserInvoicesActionProperty' () IN excelUserInvoices;
importUserInvoicesAction 'Импортировать остатки'  INTERNAL  'lsfusion.erp.region.by.integration.excel.ImportExcelUserInvoicesActionProperty' () IN excelUserInvoices;

createTemplateAllAction 'Создать все шаблоны'  INTERNAL  'lsfusion.erp.region.by.integration.excel.CreateExcelTemplateAllActionProperty' () IN excelAll;
importAllAction 'Импортировать всё'  INTERNAL  'lsfusion.erp.region.by.integration.excel.ImportExcelAllActionProperty' () IN excelAll;
skipKeysExcel 'Игнорировать несуществующие коды' = DATA BOOLEAN() IN excelAll;

EXTEND FORM integrationData
    PROPERTIES() createTemplateAllAction, importAllAction, skipKeysExcel,
    createTemplateUOMsAction, importUOMsAction,
    createTemplateItemsAction, importItemsAction, importItemsOnlyEAN, createTemplateGroupItemsAction, importGroupItemsAction,
    createTemplateBanksAction, importBanksAction, createTemplateLegalEntitiesAction, importLegalEntitiesAction,
    createTemplateStoresAction, importStoresAction, createTemplateDepartmentStoresAction, importDepartmentStoresAction,
    createTemplateWarehousesAction, importWarehousesAction, createTemplateContractsAction, importContractsAction,
    createTemplateUserInvoicesAction, importUserInvoicesAction
;
DESIGN integrationData {
    pane {
        NEW importExcel {
            type = CONTAINERV;
            caption = 'Импорт из Excel';
            MOVE GROUP(excelAll) {
                type = CONTAINERH;
            };
            MOVE GROUP(excelGroupItems) {
                type = CONTAINERH;
            };
            MOVE GROUP(excelUOMs) {
                type = CONTAINERH;
            };
            MOVE GROUP(excelItems) {
                type = CONTAINERH;
            };
            MOVE GROUP(excelBanks) {
                type = CONTAINERH;
            };
            MOVE GROUP(excelLegalEntities) {
                type = CONTAINERH;
            };
            MOVE GROUP(excelStores){
                type = CONTAINERH;
            };
            MOVE GROUP(excelDepartmentStores){
                type = CONTAINERH;
            };
            MOVE GROUP(excelWarehouses){
                type = CONTAINERH;
            };
            MOVE GROUP(excelContracts){
                type = CONTAINERH;
            };
            MOVE GROUP(excelUserInvoices){
                type = CONTAINERH;
            };
        }
    }
}
